# For Twig Config *`v4.1.2`*

**For Twig Config** позволяет легко и быстро начать работу над новым проектом.
Однако никто не отменяет необходимости **настроек или удаления лишнего**, в зависимости от требований.

 ## Запуск сборки и файлы окружения
 | Файл | Описание | Команда |
 | ------ | ------ | ------ |
 | ```.env.local``` | Конфигурация локального окружения | ```> npm run start``` |
 | ```.env.development``` | Конфгурация окружения в **development** режиме | ```> npm run build_dev``` |
 | ```.env.production``` | Конфигурация **production** окружения | ```> npm run build_prod``` |
 | ```.env.stage``` | Конфигурация **stage** окружения  | ```> npm run build_stage``` |

 ## Как развернуть среду для проекта
 1. Скачать содержимое репозитория в папку проекта
 1. Установить: **Node.js**, **Gulp**, **Webpack**
 1. В папке проекта выполнить команду **`> npm i`**

## Если вы запускаете сборку на Windows
 + Для корректной работы переменных окружения на **Windows**, нужно **глобально** установить пакет: [win-node-env](https://www.npmjs.com/package/win-node-env).
```cmd
> npm i -g win-node-env
```

## <a name="webpack">Webpack</a>
 2. **`> npm run webpack_ОКРУЖЕНИЕ`** - сборка **Twig/JavaScript/SCSS** файлов
 2. **`> npm run webpack_local`** - запуск локального сервера, сборка и отслеживание **Twig/JavaScript/SCSS** файлов

## <a name="gulp">Gulp</a>
 3. **`> npm run gulp_ОКРУЖЕНИЕ`** - [оптимизация изображений](#img_work), [создание SVG-sprite](#svg_work), копирование фавиконок и других файлов (например MP4, MP3, PDF, PSD, AI) из *`private/**/copy/**/*.*`* в *`public/build/copy`*

## <a name="fix">fix команды</a>
Для приведения кода в единый стиль можно использовать команды:
 4. **`> yarn fix:js`** - автоматические исправления в js файлах(**./private/\*\*/\*.js**) согласно правилам из файла **`eslintrc`**
 4. **`> yarn fix:json`** - автоматические исправления в json файлах(**./private/\*\*/\*.json**)
 4. **`> yarn fix:scss`** - автоматические исправления в scss файлах(**./private/\*\*/\*.scss**) согласно правилам из файла **`eslintrc`**
 4. **`> yarn lint:js`** - проверка файлов **JS**
 4. **`> yarn lint:scss`** - проверка файлов **SCSS**
 4. **`> yarn test`** - проверка файлов **JS** и **SCSS**

## Структура
 + **public** — папка готового проекта. Содержит минифицированные оптимизированные версии файлов.
 + **private** — папка с исходниками проекта;
 + **private/_helpers** — папка с шрифтами, SCSS переменными, SVG иконками и прочими файлами/библиотеками которые не получилось подключить через [NPM](https://docs.npmjs.com/getting-started/installing-npm-packages-locally);
 + **private/page** — папка для реализации страниц;
 + **private/components/blocks** — папка для реализации блоков;
 + **private/components/ui** — папка для реализации переиспользуемых UI компонентов;
 + **private/components/typography** — папка для реализации типографических особенностей проекта;

## Рекомендации к использованию
Чтобы работа была легче и быстрее, рекомендую придерживаться следующих правил:
 5. Каждой технологии (SCSS, JavaScript, шаблонам, картинкам, тестам, документации) соответствует отдельный файл;
 5. Реализация каждой страницы/блока/модуля хранится в отдельной папке;
 5. Желательно избегать прямых зависимостей между блоками;
 5. Для установки библиотек/плагинов и т.п. используйте [NPM](https://docs.npmjs.com/getting-started/installing-npm-packages-locally);
 5. Если нет возможности установить библиотеку через **NPM**, тогда можно использовать папку *`private/_helper/libs/`*;
 5. Все файлы шрифтов желательно хранить в *`private/_helper/fonts/папка_с_названием_шрифта/Файлы`*.

## Как подключать файлы блоков/страниц?
 6. Для импорта SCSS используйте директиву [@import](http://sass-lang.com/guide#topic-5).
 6. Для импорта JS файлов используйте [ES6 import](https://developer.mozilla.org/ru/docs/Web/JavaScript/Reference/Statements/import).
 6. Для импорта Twig используйте [Twig import](https://twig.symfony.com/doc/2.x/tags/include.html).
 Есть возможность обпределить пространство имен. В файле **settings/webpack.twig.option.js** определен **`namespaces`**: вместо **./public** можно использовать **@App**
 6. При создании новой страницы, старайтесь наследовать шаблон **`index.twig`** [Twig extends](https://twig.symfony.com/doc/2.x/tags/extends.html).
 6. При создании новой страницы, в папке **private/page**, нужно создать файл *`название_страницы.json`* с правильным объектом(например {}). В этот файл можно добавлять данные для вывода в шаблонах. Данные будут доступны на всех страницах. Для облегчения форматирования можно использовать команду **`fix:json`**.
  НЕ нужно создавать файл *`название_страницы.twig.js`*, и НЕ нужно ничего добавлять в файле **`webpack.common.js`**.

## <a name="img_work">Работа с изображениями</a>
#### Временные изображения
  Такие изображения нужны только на этапах вёрстки, а складывать их нужно в *`название_блока_или_страницы/img/tmp/изображение`*.
  Временные изображения не проходят через оптимизацию, а просто копируются в папку с исходниками.
#### Изображения, которые используются в шаблоне
  Они лежат сразу в *`название_блока_или_страницы/img/`*. Если такие изображения имеют формат **[png,jpg,jpeg]**, они оптимизируются через [TinyPNG](https://tinypng.com/). А так как ***DEV_API_KEY платный***, нужно [генерировать новый ключ](https://tinypng.com/developers) каждые 500 файлов. После чего ключ нужно заменить в нужном файле окружения.
```javascript
KEY_TINY = 'w5S0zPvNBKg2Pz0fsKCND5Tnrg3SX7VY'
```
#### Изображения, которые используются в SCSS файлах
  Они лежат в *`название_блока_или_страницы/img/style`*. Эти изображения оптимизируется через Webpack, во время компиляции SCSS

## <a name="svg_work">Работа с SVG спрайтом</a>
#### Как добавить иконку в спрайт
 7. Положите SVG файл в папку *`private/_heplers/sprite/svg/`*;
 7. Выполните команду **`> npm run gulp_ОКРУЖЕНИЕ`**.

 #### Как вставить SVG спрайт на страницу
Имя иконки внутри спрайта соответствует названию её исходного SVG файла.
Например вывести иконку **`facebook.svg`** можно через имя **`#facebook`**.
 ```html
 <svg><use xlink:href="img/symbol_sprite.svg#facebook"></use></svg>
 ```
Примечание: чтобы увидеть результат, необходим запущенный сервер. Локально это можно сделать запустив  комманду **`> npm run start`**

## <a name="typography">Работа с типографией</a>
Допустим вы делаете крупный/долгий продукт с несколькими разработчиками.
Даже с одним техническим заданием, полученный результат может не собраться в единый стиль.

Каждый человек — это разные уровни понимания ТЗ, взгляд на жизнь, версия фотошопа, жидкость в бутылке у монитора…
Использование общих стилей типографии, позволяет выделить базовые начертания, цвета, размеры и т.д.

Стили типографии завязаны на теги, а применить их можно при помощи одного из классов`(.typography | .ckeditor | .cke_editable)`.
Однако есть парочка тегов, стили которых применяются в независимости от родительского класса`(h1-h6 | a)`.

Если один из стилей вам не подходит, вы можете изменить их. Для этого достаточно переопределить **SCSS** переменные.

Результаты типографии можно посмотреть в *`public/typography.html`*
